/*! project-name v0.0.1 | (c) 2021 YOUR NAME | MIT License | http://link-to-your-git-repo.com */
const start25=5,start50=10,start75=15,start100=20,getTransition=()=>d3.transition().duration(200),illustrations=["community","school","distance","waterMCL","solution","coloring"],triggerAnimations=(t,o)=>{const e=illustrationsInfo.find(o=>o.community===t),a=(t,o)=>{gsap.to(`.village-${t} .section-${o} .coloring`,{opacity:1,duration:2,ease:"sine.out"})},i=(t,o,e)=>{const a="left"===e?"-":"+";gsap.timeline().to(t,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},0).to(t,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(t,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(t,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(t,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(t,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(t,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(t,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">")},s=(o,a,s)=>{const l=e[o],n=e[s],c=gsap.timeline();switch(l){case 2:c.call(i,[`#${t}-${a}-bird1-state1`,`#${t}-${a}-bird1-state2`,n]).call(i,[`#${t}-${a}-bird2-state1`,`#${t}-${a}-bird2-state2`,n],">+1");break;case 3:c.call(i,[`#${t}-${a}-bird1-state1`,`#${t}-${a}-bird1-state2`,n]).call(i,[`#${t}-${a}-bird2-state1`,`#${t}-${a}-bird2-state2`,n],">+1").call(i,[`#${t}-${a}-bird3-state1`,`#${t}-${a}-bird3-state2`,n],">+1");break;case 4:c.call(i,[`#${t}-${a}-bird1-state1`,`#${t}-${a}-bird1-state2`,n]).call(i,[`#${t}-${a}-bird2-state1`,`#${t}-${a}-bird2-state2`,n],">+1").call(i,[`#${t}-${a}-bird3-state1`,`#${t}-${a}-bird3-state2`,n],">+1").call(i,[`#${t}-${a}-bird4-state1`,`#${t}-${a}-bird4-state2`,n],">+1")}},l=(o,e,a,i,s)=>{gsap.set(`#${t}-${o}-wheel-back, #${t}-${o}-wheel-front`,{transformOrigin:"50% 50%"},0);const l="las-mercedes"===t?"back.in(1.2)":"back.in(1.7)",n="las-mercedes"===t?"back.out(1.1)":"back.out(1.4)",c="+"===a?"-":"+",r="las-mercedes"===t?3:2,d="las-mercedes"===t?2.5:1;gsap.timeline().to(`#${t}-${o}-wheel-back`,{rotation:`${a}=${i}`,duration:r,ease:l},3.1).to(`#${t}-${o}-wheel-front`,{rotation:`${a}=${s}`,duration:r,ease:l},3.1).to(`#${t}-${o}-tractor`,{x:`${a}${e}`,duration:r,ease:l},3.1).to(`#${t}-${o}-wheel-back`,{rotation:`${c}=${i}`,duration:d,ease:n},r+5).to(`#${t}-${o}-wheel-front`,{rotation:`${c}=${s}`,duration:d,ease:n},r+5).to(`#${t}-${o}-tractor`,{x:0,duration:d,ease:n},r+5)},n=o=>{const e=gsap.timeline();e.to(`#${t}-${o}-river-tides`,{x:"+=30",opacity:1,duration:4,ease:"none"}).to(`#${t}-${o}-river-tides`,{x:"+=30",opacity:0,duration:4,ease:"none"}),e.repeat(-1).repeatDelay(2)},c=t=>{t.forEach(t=>{gsap.to(t.selector,{drawSVG:"100%",duration:2})})};if(o>=25){const s={trigger:`.village-${t} .section-community svg`,start:"top center",end:"bottom 0",onEnterBack:()=>n.restart(),onLeave:()=>n.pause()},n=gsap.timeline({scrollTrigger:s});o>=75&&e.animalsCommunity.forEach(o=>{o.selector=document.querySelectorAll(`#${t}-community-${o.id} path, #${t}-community-${o.id} line, #${t}-community-${o.id} polyline`),gsap.set(o.selector,{drawSVG:0})});const r=`${e.cloudsCommunity.direction}=${e.cloudsCommunity.distance}`;"totoral-bajo"===t?gsap.set(`#${t}-community-clouds-back-outline`,{x:r,opacity:0}):"las-mercedes"===t?gsap.set(`#${t}-community-clouds-front-outline, #${t}-community-clouds-back-outline`,{x:r,opacity:0}):"carrizalillo"===t?gsap.set(`#${t}-community-clouds-outline`,{x:r,opacity:0}):"la-merced"!==t&&"totoral-alto"!==t||gsap.set(`#${t}-community-sun`,{opacity:0,y:20}),"la-merced"!==t&&"las-mercedes"!==t&&"totoral-alto"!==t&&"carrizalillo"!==t&&(gsap.set(`#${t}-community-clouds-front`,{opacity:0}),gsap.set(`#${t}-community-clouds-front`,{x:r}));const d=()=>{const o=gsap.timeline();"totoral-bajo"===t?o.to(`#${t}-community-clouds-front`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${t}-community-clouds-front`,{x:-1*r,duration:20,ease:"sine.out"},"<-1").to(`#${t}-community-clouds-back-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${t}-community-clouds-back-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1"):"las-mercedes"===t?o.to(`#${t}-community-clouds-front, #${t}-community-clouds-front-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${t}-community-clouds-front, #${t}-community-clouds-front-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1").to(`#${t}-community-clouds-back-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${t}-community-clouds-back-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1"):"carrizalillo"===t?o.to(`#${t}-community-clouds-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${t}-community-clouds-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1"):"la-merced"===t||"totoral-alto"===t?o.to(`#${t}-community-sun`,{opacity:1,duration:1,ease:"sine.out"},0).to(`#${t}-community-sun`,{y:0,duration:8,ease:"sine.out"},"<-1"):o.to(`#${t}-community-clouds-front`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${t}-community-clouds-front`,{x:-1*r,duration:20,ease:"sine.out"},"<-1")},m=()=>{gsap.timeline().call(l,["community",e.vehicleCommunity.distance,e.vehicleCommunity.direction,e.vehicleCommunity.rotationWheelBack,e.vehicleCommunity.rotationWheelFront])},u=()=>{gsap.timeline().call(c,[e.animalsCommunity])},$=()=>{const o=gsap.timeline();"totoral-alto"===t?o.call(i,[`#${t}-community-bird1-state1`,`#${t}-community-bird1-state2`,"right"]).call(i,[`#${t}-community-bird3-state1`,`#${t}-community-bird3-state2`,"left"],">+1").call(i,[`#${t}-community-bird2-state1`,`#${t}-community-bird2-state2`,"left"],">+1"):"totoral-bajo"==t?o.call(i,[`#${t}-community-bird1-state1`,`#${t}-community-bird1-state2`,"left"]).call(i,[`#${t}-community-bird3-state1`,`#${t}-community-bird3-state2`,"left"],">+1").call(i,[`#${t}-community-bird2-state1`,`#${t}-community-bird2-state2`,"left"],">+1"):o.call(i,[`#${t}-community-bird2-state1`,`#${t}-community-bird2-state2`,"left"]).call(i,[`#${t}-community-bird1-state1`,`#${t}-community-bird1-state2`,"left"],1)},p=[{level:25,timing:4},{level:50,timing:12},{level:75,timing:12},{level:100,timing:14}];n.call(d,null,1).call(a,[t,"community"],p.find(t=>t.level===o).timing),o>=50&&n.add(m,4),o>=75&&n.add(u,8),100===o&&n.add($,12)}const r={trigger:`.village-${t} .section-school svg`,start:"top center",end:"bottom 0",onEnterBack:()=>d.restart(),onLeave:()=>d.pause()},d=gsap.timeline({scrollTrigger:r}),m=e.missedSchoolHours.max/3;gsap.set(`#${t}-school-clock-small-hand`,{transformOrigin:"bottom center"},0),gsap.set(`#${t}-school-clock-big-hand`,{transformOrigin:"bottom center"},0),gsap.set(`#${t}-school-clock-mouth`,{opacity:0}),o<25&&(gsap.set(`#${t}-school-clock-small-hand`,{rotation:210}),gsap.set(`#${t}-school-clock-big-hand`,{rotation:135}));let u=document.querySelectorAll(`#${t}-school-kids polygon, #${t}-school-kids polyline, #${t}-school-kids path, #${t}-school-kids ellipse`),$=document.querySelectorAll(`#${t}-school-kid1-mouth, #${t}-school-kid2-mouth`);gsap.set($,{opacity:0}),100===o&&gsap.set(u,{drawSVG:0});const p=document.querySelector(`#${t}-school-clock-tear-left`),g=document.querySelector(`#${t}-school-clock-tear-right`);gsap.set(p,{drawSVG:"0% 100%",y:0}),gsap.set(g,{drawSVG:"0% 100%",y:0});const h=()=>{schoolTearsTl=gsap.timeline(),schoolTearsTl.from(p,{drawSVG:0,duration:.7,ease:"none"},0).to(p,{y:25,duration:1,ease:"power2.in"}).to(p,{drawSVG:"100% 100%",opacity:0,duration:.1}).from(g,{drawSVG:0,duration:.7,ease:"none"},3.2).to(g,{y:25,duration:1,ease:"power2.in"}).to(g,{drawSVG:"100% 100%",opacity:0,duration:.1});const t=o<100?-1:Math.floor(9/4.2)-1;schoolTearsTl.repeat(t)},b=()=>{schoolFlagsTl=gsap.timeline(),e.hasTwoSchools?schoolFlagsTl.to(`#${t}-school-flag-top-state1`,{morphSVG:`#${t}-school-flag-top-state2`,duration:.8,ease:"none"}).to(`#${t}-school-flag-top-state1`,{morphSVG:`#${t}-school-flag-top-state3`,duration:.8,ease:"none"},">").to(`#${t}-school-flag-top-state1`,{morphSVG:`#${t}-school-flag-top-state1`,duration:.8,ease:"none"},">").to(`#${t}-school-flag-bottom-state1`,{morphSVG:`#${t}-school-flag-bottom-state2`,duration:.8,ease:"none"},.2).to(`#${t}-school-flag-bottom-state1`,{morphSVG:`#${t}-school-flag-bottom-state3`,duration:.8,ease:"none"},">").to(`#${t}-school-flag-bottom-state1`,{morphSVG:`#${t}-school-flag-bottom-state1`,duration:.8,ease:"none"},">"):schoolFlagsTl.to(`#${t}-school-flag-state1`,{morphSVG:`#${t}-school-flag-state2`,duration:.8,ease:"none"}).to(`#${t}-school-flag-state1`,{morphSVG:`#${t}-school-flag-state3`,duration:.8,ease:"none"},">").to(`#${t}-school-flag-state1`,{morphSVG:`#${t}-school-flag-state1`,duration:.8,ease:"none"},">"),schoolFlagsTl.repeat(-1)},f=()=>{gsap.timeline().to(`#${t}-school-clock-small-hand`,{rotation:360*e.missedSchoolHours.max/12,duration:m,ease:"none"},0).to(`#${t}-school-clock-big-hand`,{rotation:360*e.missedSchoolHours.max,duration:m,ease:"none"},0).call(h,null,0)};gsap.set(`#${t}-school-door-left`,{x:0}),gsap.set(`#${t}-school-door-right`,{x:0});const S=()=>{gsap.timeline().to(`#${t}-school-door-left`,{x:"-95%",duration:2,ease:"power2.in"},0).to(`#${t}-school-door-right`,{x:"95%",duration:2,ease:"power2.in"},0)},w=()=>{gsap.timeline().to(u,{drawSVG:"100%",duration:2}).fromTo(`#${t}-school-clock-mouth`,{drawSVG:"50% 50%"},{drawSVG:"0 100%",opacity:1,duration:1,ease:"sine.in"},">-0.8").fromTo($,{drawSVG:"50% 50%"},{drawSVG:"0 100%",opacity:1,duration:1,ease:"sine.in"},">-0.8")},k=[{level:25,timing:4},{level:50,timing:4},{level:75,timing:8},{level:100,timing:11}];if(o>=25&&d.call(a,[t,"school"],k.find(t=>t.level===o).timing).add(f,2),o>=50&&d.add(b,0),o>=75&&d.add(S,6),100===o&&d.add(w,9),gsap.set(`#${t}-distance-walk`,{opacity:0}),o>=25){const i={trigger:`.village-${t} .section-distance svg`,start:"top center",end:"bottom 0",onEnterBack:()=>l.restart(),onLeave:()=>l.pause()},l=gsap.timeline({scrollTrigger:i});let r;gsap.set(`#${t}-distance-walk`,{drawSVG:"0% 100%",opacity:1}),gsap.set(`#${t}-distance-arrowhead`,{drawSVG:"50% 50%",opacity:0}),o>=50&&"carrizalillo"!==t&&(gsap.set(`#${t}-distance-river-tides`,{opacity:0}),gsap.set(`#${t}-distance-river-tides`,{x:"-=20"})),100===o&&e.animalsDistance.forEach(o=>{o.selector=document.querySelectorAll(`#${t}-distance-${o.id} path, #${t}-distance-${o.id} line, #${t}-distance-${o.id} polyline`),gsap.set(o.selector,{drawSVG:0})}),"carrizalillo"===t&&o>=50&&(r=document.querySelectorAll("#carrizalillo-distance-well polygon, #carrizalillo-distance-well line, #carrizalillo-distance-well rect, #carrizalillo-distance-well polyline"),gsap.set(r,{drawSVG:0}));const d=()=>{const o=gsap.timeline();"carrizalillo"===t?o.to(r,{drawSVG:"100%",duration:2},2):o.call(n,["distance"])},m=()=>{gsap.timeline().call(s,["numberOfBirdsDistance","distance","directionBirdsDistance"])},u=()=>{gsap.timeline().call(c,[e.animalsDistance])},$=[{level:25,timing:4},{level:50,timing:4},{level:75,timing:8},{level:100,timing:11}];l.to(`#${t}-distance-walk`,{drawSVG:"100% 100%",duration:3,ease:"none"},2).to(`#${t}-distance-arrowhead`,{drawSVG:"0 100%",opacity:1,duration:.5,ease:"power1.in"}).call(a,[t,"distance"],$.find(t=>t.level===o).timing),o>=50&&l.add(d,0),o>=75&&l.add(m,6),100===o&&l.add(u,9)}};