/*! project-name v0.0.1 | (c) 2021 YOUR NAME | MIT License | http://link-to-your-git-repo.com */
const start25=5,start50=10,start75=15,start100=20,getTransition=()=>d3.transition().duration(200),illustrations=["community","school","distance","waterMCL","solution","coloring"],triggerAnimations=(o,t)=>{const e=illustrationsInfo.find(t=>t.community===o),a=(o,t)=>{gsap.to(`.village-${o} .section-${t} .coloring`,{opacity:1,duration:2,ease:"sine.out"})},s=(o,t,e)=>{const a="left"===e?"-":"+";gsap.timeline().to(o,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},0).to(o,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:t,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:o,x:`${a}=10`,y:y="-=15",duration:.4,ease:"none"},">")},i=(t,e,a,s,i)=>{gsap.set(`#${o}-${t}-wheel-back, #${o}-${t}-wheel-front`,{transformOrigin:"50% 50%"},0);const n="las-mercedes"===o?"back.in(1.2)":"back.in(1.7)",l="las-mercedes"===o?"back.out(1.1)":"back.out(1.4)",c="+"===a?"-":"+",r="las-mercedes"===o?3:2,m="las-mercedes"===o?2.5:1;gsap.timeline().to(`#${o}-${t}-wheel-back`,{rotation:`${a}=${s}`,duration:r,ease:n},3.1).to(`#${o}-${t}-wheel-front`,{rotation:`${a}=${i}`,duration:r,ease:n},3.1).to(`#${o}-${t}-tractor`,{x:`${a}${e}`,duration:r,ease:n},3.1).to(`#${o}-${t}-wheel-back`,{rotation:`${c}=${s}`,duration:m,ease:l},r+5).to(`#${o}-${t}-wheel-front`,{rotation:`${c}=${i}`,duration:m,ease:l},r+5).to(`#${o}-${t}-tractor`,{x:0,duration:m,ease:l},r+5)},n=o=>{o.forEach(o=>{gsap.to(o.selector,{drawSVG:"100%",duration:2})})};if(t>=25){const l={trigger:`.village-${o} .section-community svg`,start:"top center",end:"bottom 0",onEnterBack:()=>c.restart(),onLeave:()=>c.pause()},c=gsap.timeline({scrollTrigger:l});t>=75&&e.animalsCommunity.forEach(t=>{t.selector=document.querySelectorAll(`#${o}-community-${t.id} path, #${o}-community-${t.id} line, #${o}-community-${t.id} polyline`),gsap.set(t.selector,{drawSVG:0})});const r=`${e.cloudsCommunity.direction}=${e.cloudsCommunity.distance}`;"totoral-bajo"===o?gsap.set(`#${o}-community-clouds-back-outline`,{x:r,opacity:0}):"las-mercedes"===o?gsap.set(`#${o}-community-clouds-front-outline, #${o}-community-clouds-back-outline`,{x:r,opacity:0}):"carrizalillo"===o?gsap.set(`#${o}-community-clouds-outline`,{x:r,opacity:0}):"la-merced"!==o&&"totoral-alto"!==o||gsap.set(`#${o}-community-sun`,{opacity:0,y:20}),"la-merced"!==o&&"las-mercedes"!==o&&"totoral-alto"!==o&&"carrizalillo"!==o&&(gsap.set(`#${o}-community-clouds-front`,{opacity:0}),gsap.set(`#${o}-community-clouds-front`,{x:r}));const m=()=>{const t=gsap.timeline();"totoral-bajo"===o?t.to(`#${o}-community-clouds-front`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${o}-community-clouds-front`,{x:-1*r,duration:20,ease:"sine.out"},"<-1").to(`#${o}-community-clouds-back-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${o}-community-clouds-back-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1"):"las-mercedes"===o?t.to(`#${o}-community-clouds-front, #${o}-community-clouds-front-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${o}-community-clouds-front, #${o}-community-clouds-front-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1").to(`#${o}-community-clouds-back-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${o}-community-clouds-back-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1"):"carrizalillo"===o?t.to(`#${o}-community-clouds-outline`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${o}-community-clouds-outline`,{x:-1*r,duration:20,ease:"sine.out"},"<-1"):"la-merced"===o||"totoral-alto"===o?t.to(`#${o}-community-sun`,{opacity:1,duration:1,ease:"sine.out"},0).to(`#${o}-community-sun`,{y:0,duration:8,ease:"sine.out"},"<-1"):t.to(`#${o}-community-clouds-front`,{opacity:1,duration:3,ease:"sine.out"},0).to(`#${o}-community-clouds-front`,{x:-1*r,duration:20,ease:"sine.out"},"<-1")},u=()=>{gsap.timeline().call(i,["community",e.vehicleCommunity.distance,e.vehicleCommunity.direction,e.vehicleCommunity.rotationWheelBack,e.vehicleCommunity.rotationWheelFront])},d=()=>{gsap.timeline().call(n,[e.animalsCommunity])},$=()=>{const t=gsap.timeline();"totoral-alto"===o?t.call(s,[`#${o}-community-bird1-state1`,`#${o}-community-bird1-state2`,"right"]).call(s,[`#${o}-community-bird3-state1`,`#${o}-community-bird3-state2`,"left"],">+1").call(s,[`#${o}-community-bird2-state1`,`#${o}-community-bird2-state2`,"left"],">+1"):"totoral-bajo"==o?t.call(s,[`#${o}-community-bird1-state1`,`#${o}-community-bird1-state2`,"left"]).call(s,[`#${o}-community-bird3-state1`,`#${o}-community-bird3-state2`,"left"],">+1").call(s,[`#${o}-community-bird2-state1`,`#${o}-community-bird2-state2`,"left"],">+1"):t.call(s,[`#${o}-community-bird2-state1`,`#${o}-community-bird2-state2`,"left"]).call(s,[`#${o}-community-bird1-state1`,`#${o}-community-bird1-state2`,"left"],1)},y=[{level:25,timing:4},{level:50,timing:12},{level:75,timing:12},{level:100,timing:14}];c.call(m,null,1).call(a,[o,"community"],y.find(o=>o.level===t).timing),t>=50&&c.add(u,4),t>=75&&c.add(d,8),100===t&&c.add($,12)}const l={trigger:`.village-${o} .section-school svg`,start:"top center",end:"bottom 0",onEnterBack:()=>c.restart(),onLeave:()=>c.pause()},c=gsap.timeline({scrollTrigger:l}),r=e.missedSchoolHours.max/3;gsap.set(`#${o}-school-clock-small-hand`,{transformOrigin:"bottom center"},0),gsap.set(`#${o}-school-clock-big-hand`,{transformOrigin:"bottom center"},0),gsap.set(`#${o}-school-clock-mouth`,{opacity:0}),t<25&&(gsap.set(`#${o}-school-clock-small-hand`,{rotation:210}),gsap.set(`#${o}-school-clock-big-hand`,{rotation:135}));let m=document.querySelectorAll(`#${o}-school-kids polygon, #${o}-school-kids polyline, #${o}-school-kids path, #${o}-school-kids ellipse`),u=document.querySelectorAll(`#${o}-school-kid1-mouth, #${o}-school-kid2-mouth`);gsap.set(u,{opacity:0}),100===t&&gsap.set(m,{drawSVG:0});const d=document.querySelector(`#${o}-school-clock-tear-left`),$=document.querySelector(`#${o}-school-clock-tear-right`);gsap.set(d,{drawSVG:"0% 100%",y:0}),gsap.set($,{drawSVG:"0% 100%",y:0});const h=()=>{schoolTearsTl=gsap.timeline(),schoolTearsTl.from(d,{drawSVG:0,duration:.7,ease:"none"},0).to(d,{y:25,duration:1,ease:"power2.in"}).to(d,{drawSVG:"100% 100%",opacity:0,duration:.1}).from($,{drawSVG:0,duration:.7,ease:"none"},3.2).to($,{y:25,duration:1,ease:"power2.in"}).to($,{drawSVG:"100% 100%",opacity:0,duration:.1});const o=t<100?-1:Math.floor(9/4.2)-1;schoolTearsTl.repeat(o)},g=()=>{schoolFlagsTl=gsap.timeline(),e.hasTwoSchools?schoolFlagsTl.to(`#${o}-school-flag-top-state1`,{morphSVG:`#${o}-school-flag-top-state2`,duration:.8,ease:"none"}).to(`#${o}-school-flag-top-state1`,{morphSVG:`#${o}-school-flag-top-state3`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-top-state1`,{morphSVG:`#${o}-school-flag-top-state1`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-bottom-state1`,{morphSVG:`#${o}-school-flag-bottom-state2`,duration:.8,ease:"none"},.2).to(`#${o}-school-flag-bottom-state1`,{morphSVG:`#${o}-school-flag-bottom-state3`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-bottom-state1`,{morphSVG:`#${o}-school-flag-bottom-state1`,duration:.8,ease:"none"},">"):schoolFlagsTl.to(`#${o}-school-flag-state1`,{morphSVG:`#${o}-school-flag-state2`,duration:.8,ease:"none"}).to(`#${o}-school-flag-state1`,{morphSVG:`#${o}-school-flag-state3`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-state1`,{morphSVG:`#${o}-school-flag-state1`,duration:.8,ease:"none"},">"),schoolFlagsTl.repeat(-1)},p=()=>{gsap.timeline().to(`#${o}-school-clock-small-hand`,{rotation:360*e.missedSchoolHours.max/12,duration:r,ease:"none"},0).to(`#${o}-school-clock-big-hand`,{rotation:360*e.missedSchoolHours.max,duration:r,ease:"none"},0).call(h,null,0)};gsap.set(`#${o}-school-door-left`,{x:0}),gsap.set(`#${o}-school-door-right`,{x:0});const f=()=>{gsap.timeline().to(`#${o}-school-door-left`,{x:"-95%",duration:2,ease:"power2.in"},0).to(`#${o}-school-door-right`,{x:"95%",duration:2,ease:"power2.in"},0)},b=()=>{gsap.timeline().to(m,{drawSVG:"100%",duration:2}).fromTo(`#${o}-school-clock-mouth`,{drawSVG:"50% 50%"},{drawSVG:"0 100%",opacity:1,duration:1,ease:"sine.in"},">-0.8").fromTo(u,{drawSVG:"50% 50%"},{drawSVG:"0 100%",opacity:1,duration:1,ease:"sine.in"},">-0.8")},S=[{level:25,timing:4},{level:50,timing:4},{level:75,timing:8},{level:100,timing:11}];t>=25&&c.call(a,[o,"school"],S.find(o=>o.level===t).timing).add(p,2),t>=50&&c.add(g,0),t>=75&&c.add(f,6),100===t&&c.add(b,9)};