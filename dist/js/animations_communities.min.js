/*! project-name v0.0.1 | (c) 2021 YOUR NAME | MIT License | http://link-to-your-git-repo.com */
const start25=5,start50=10,start75=15,start100=20,getTransition=()=>d3.transition().duration(200),illustrations=["community","school","distance","waterMCL","solution","coloring"],triggerAnimations=o=>{const t=illustrationsInfo.find(t=>t.community===o);null===document.querySelector(`.village-${o} .section-community .counter`)&&illustrations.forEach(t=>{d3.select(`.village-${o} .section-${t}`).append("div").attr("class","counter").text("0%")});const e=(t,e)=>{d3.select(`.village-${o} .section-${t} .counter`).transition(getTransition()).style("opacity",0).transition(getTransition()).text(`${e}%`).transition(getTransition()).style("opacity",1)},a=(o,t)=>{gsap.timeline().to(o,{morphSVG:t,x:"-=10",y:y="-=15",duration:.4,ease:"none"},0).to(o,{morphSVG:o,x:"-=10",y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:t,x:"-=10",y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:o,x:"-=10",y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:t,x:"-=10",y:y="-=15",duration:.4,ease:"none"},">").to(o,{morphSVG:o,x:"-=10",y:y="-=15",duration:.4,ease:"none"},">")},s={trigger:`.village-${o} .section-community svg`,start:"top center",end:"bottom 0",onEnterBack:()=>l.restart(),onLeave:()=>l.pause()},l=gsap.timeline({scrollTrigger:s});t.animalsCommunity.forEach(t=>{t.selector=document.querySelectorAll(`#${o}-community-${t.id} path, #${o}-community-${t.id} line, #${o}-community-${t.id} polyline`),gsap.set(t.selector,{drawSVG:0})});l.call(e,["community",25],5).call(()=>{gsap.to(`#cloud-color-1, #${o}-community-clouds-back`,{opacity:.42,duration:1,ease:"power1.out"}),gsap.to(`#${o}-community-sun-color`,{opacity:.8,duration:1,ease:"power1.out"}),gsap.timeline().fromTo(`#${o}-community-clouds-front`,{x:220},{x:-300,duration:50,repeat:-1,ease:"none"},0).fromTo(`#${o}-community-clouds-back`,{x:220},{x:-300,duration:80,repeat:-1,ease:"none"},0)},null,5).call(e,["community",50],10).call((t,e,a,s,l)=>{gsap.set(`#${o}-${t}-wheel-back, #${o}-${t}-wheel-front`,{transformOrigin:"50% 50%"},0);const n="back.in(1.7)",r="+"===a?"-":"+",i=gsap.timeline();i.to(`#${o}-${t}-wheel-back`,{rotation:`${a}=${s}`,duration:2,ease:n},0).to(`#${o}-${t}-wheel-front`,{rotation:`${a}=${l}`,duration:2,ease:n},0).to(`#${o}-${t}-tractor`,{x:`${a}${e}`,duration:2,ease:n},0).to(`#${o}-${t}-wheel-back`,{rotation:`${r}=${s}`,duration:1,ease:"back.out(1.4)"},7).to(`#${o}-${t}-wheel-front`,{rotation:`${r}=${l}`,duration:1,ease:"back.out(1.4)"},17).to(`#${o}-${t}-tractor`,{x:0,duration:1,ease:"back.out(1.4)"},7),i.repeat(-1).repeatDelay(10).yoyo(!0)},["community",t.vehicleCommunity.distance,t.vehicleCommunity.direction,t.vehicleCommunity.rotationWheelBack,t.vehicleCommunity.rotationWheelFront],10).call(e,["community",75],15).call(o=>{o.forEach(o=>{gsap.to(o.selector,{drawSVG:"100%",duration:2})})},[t.animalsCommunity],15).call(e,["community",100],20).call(a,[`#${o}-community-bird2-state1`,`#${o}-community-bird2-state2`],20).call(a,[`#${o}-community-bird1-state1`,`#${o}-community-bird1-state2`],21);const n={trigger:`.village-${o} .section-school svg`,start:"top center",end:"bottom 0",onEnterBack:()=>r.restart(),onLeave:()=>r.pause()},r=gsap.timeline({scrollTrigger:n}),i=document.querySelectorAll(`#${o}-school-kids polygon, #${o}-school-kids polyline, #${o}-school-kids path, #${o}-school-kids ellipse`),c=document.querySelectorAll(`#${o}-school-kid1-mouth, #${o}-school-kid2-mouth`);gsap.set(`#${o}-school-clock-small-hand`,{transformOrigin:"bottom center"},0),gsap.set(`#${o}-school-clock-big-hand`,{transformOrigin:"bottom center"},0),gsap.set(`#${o}-school-clock-mouth`,{opacity:0}),gsap.set(c,{opacity:0}),t.hasTwoSchools?gsap.set(`#${o}-school-flag-top-state2, #${o}-school-flag-top-state3, #${o}-school-flag-bottom-state2, #${o}-school-flag-bottom-state3`,{opacity:0},0):gsap.set(`#${o}-school-flag-state2, #${o}-school-flag-state3`,{opacity:0},0);r.to(`#${o}-school-clock-small-hand`,{rotation:360*t.missedSchoolHours.max/12,duration:3,ease:"none"},2).to(`#${o}-school-clock-big-hand`,{rotation:360*t.missedSchoolHours.max,duration:3,ease:"none"},2).call(()=>{const t=document.querySelector(`#${o}-school-clock-tear-left`),e=document.querySelector(`#${o}-school-clock-tear-right`);schoolTearsTl=gsap.timeline(),schoolTearsTl.from(t,{drawSVG:0,duration:.7,ease:"none"},0).to(t,{y:25,duration:1,ease:"power2.in"}).to(t,{drawSVG:"100% 100%",opacity:0,duration:.1}).from(e,{drawSVG:0,duration:.7,ease:"none"},3.2).to(e,{y:25,duration:1,ease:"power2.in"}).to(e,{drawSVG:"100% 100%",opacity:0,duration:.1}),schoolTearsTl.repeat(Math.floor(20/4.2)-1)},null,2).call(e,["school",25],5).call(()=>{schoolFlagsTl=gsap.timeline(),t.hasTwoSchools?schoolFlagsTl.to(`#${o}-school-flag-top-state1`,{morphSVG:`#${o}-school-flag-top-state2`,duration:.8,ease:"none"}).to(`#${o}-school-flag-top-state1`,{morphSVG:`#${o}-school-flag-top-state3`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-top-state1`,{morphSVG:`#${o}-school-flag-top-state1`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-bottom-state1`,{morphSVG:`#${o}-school-flag-bottom-state2`,duration:.8,ease:"none"},.2).to(`#${o}-school-flag-bottom-state1`,{morphSVG:`#${o}-school-flag-bottom-state3`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-bottom-state1`,{morphSVG:`#${o}-school-flag-bottom-state1`,duration:.8,ease:"none"},">"):schoolFlagsTl.to(`#${o}-school-flag-state1`,{morphSVG:`#${o}-school-flag-state2`,duration:.8,ease:"none"}).to(`#${o}-school-flag-state1`,{morphSVG:`#${o}-school-flag-state3`,duration:.8,ease:"none"},">").to(`#${o}-school-flag-state1`,{morphSVG:`#${o}-school-flag-state1`,duration:.8,ease:"none"},">"),schoolFlagsTl.repeat(-1)},null,5).call(e,["school",50],10).from(i,{drawSVG:0,duration:2},10).call(e,["school",75],15).to(`#${o}-school-door-left`,{x:"-95%",duration:2,ease:"power2.in"},15).to(`#${o}-school-door-right`,{x:"95%",duration:2,ease:"power2.in"},15).call(e,["school",100],20).fromTo(`#${o}-school-clock-mouth`,{drawSVG:"50% 50%"},{drawSVG:"0 100%",opacity:1,duration:1,ease:"sine.in"},20).fromTo(c,{drawSVG:"50% 50%"},{drawSVG:"0 100%",opacity:1,duration:1,ease:"sine.in"},20)};